/* Page-specific styles for Category page */

/* Full-width hero with background image and overlay content */
.category-hero {
  position: relative;
  margin-top: 0; /* ensure no top gap */
  /* Solid background ensures perfect blend when image is masked */
  background: var(--bg-off-white, #F5F1ED);
}
.category-hero .category-hero-bg {
  position: relative;
  width: 100%;
  height: 38vh; /* initial height; can be tuned */
  min-height: 220px;
  max-height: 520px;
  z-index: 0;
  /* Paint two backgrounds: top transparent -> bottom page color, then image */
  background-image:
    linear-gradient(to bottom, rgba(245,241,237,0) 50%, rgba(245,241,237,1) 100%),
    var(--hero-image);
  background-repeat: no-repeat, no-repeat;
  background-size: 100% 100%, cover; /* cover = crop (no squish) */
  background-position: top, center;
}
.category-hero .category-hero-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: flex-end;
  padding: 1.25rem 0 1.5rem;
  color: var(--text-charcoal);
  z-index: 2;
}
/* bottom-fade layer no longer needed because gradient is baked into background */

#category-root .category-breadcrumbs {
  margin-top: .25rem;
}

/* Remove boxed panel look; tree should blend with background */
#category-root .category-panel {
  background: transparent;
  border: 0;
  border-radius: 0;
}

/* Translucent text panel to maintain readability over images */
.category-hero .text-panel {
  display: inline-block;
  background: rgba(245,241,237,0.5);
  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
  border-radius: .5rem;
  padding: .75rem 1rem;
  box-shadow: 0 4px 16px rgba(0,0,0,0.08);
  max-width: 100%;
}

/* Improve breadcrumb contrast within the hero panel */
.category-hero .text-panel .breadcrumb {
  color: var(--text-charcoal, #333333);
  margin-bottom: 0;
  /* Bootstrap 5 variable for divider color */
  --bs-breadcrumb-divider-color: rgba(51,51,51,0.6);
}
.category-hero .text-panel .breadcrumb .breadcrumb-item a {
  color: var(--text-charcoal, #333333) !important;
  text-decoration: none;
}
.category-hero .text-panel .breadcrumb .breadcrumb-item a:hover,
.category-hero .text-panel .breadcrumb .breadcrumb-item a:focus {
  text-decoration: underline;
}
.category-hero .text-panel .breadcrumb .breadcrumb-item + .breadcrumb-item::before {
  color: rgba(51,51,51,0.6);
}
.category-hero .text-panel .breadcrumb .breadcrumb-item.active {
  color: var(--text-charcoal, #333333);
  font-weight: 600;
}

/* Category tree (always expanded) */
.category-tree { }
.category-tree .item { position: relative; }
.category-tree ul { margin: 0; }
.category-tree .category-item { padding: 0 !important; margin: 0; }
.category-tree .item { padding-top: 4px; padding-bottom: 4px; }
.category-tree .category-link {
  color: var(--text-charcoal, #333333);
  text-decoration: none;
  display: inline-block;
}
.category-tree .category-link:hover,
.category-tree .category-link:focus { text-decoration: underline; }
.category-tree .category-item.active > .item { font-weight: 700; }
.category-tree .category-item.active > .item::before {
  content: "";
  position: absolute;
  left: 4px;
  top: 0;
  bottom: 0;
  width: 3px;
  background: #4A5D52; /* primary */
  border-radius: 2px;
}
.category-tree .category-item.ancestor > .item { font-weight: 600; }

/* Current (active) category label is not a link */
.category-tree .category-current {
  color: var(--text-charcoal, #333333);
  text-decoration: none;
  cursor: default;
}

/* Product card placeholders while rebuilding */
.product-card .product-card-img {
  position: relative;
  width: 100%;
  padding-top: 62.5%; /* 16:10 ratio placeholder */
  border-bottom: 1px solid var(--border-grey, #D9D9D9);
}
.product-card .product-card-img img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform .25s ease;
  z-index: 0;
}
.product-card:hover .product-card-img img {
  transform: scale(1.03);
}

/* Tweak placeholder asset scaling so it doesn't overwhelm the frame */
.product-card .product-card-img img[src$="no-image.png"] {
  width: 60%;
  height: 60%;
  object-fit: contain;
  margin: auto; /* centers with inset: 0 */
}
.product-card:hover .product-card-img img[src$="no-image.png"] {
  transform: none; /* don't zoom the placeholder */
}

/* Visually distinguish non-purchasable states */
/* Dim state: keep colors visible, add a soft overlay and mute text */
.product-card.dimmed .product-card-img::after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(255, 255, 255, 0.55);
  pointer-events: none;
  z-index: 1;
  /* Slightly reduce contrast without killing color */
  backdrop-filter: saturate(0.9) brightness(0.92);
}
.product-card.dimmed .card-title { color: #6c757d; }
.product-card.dimmed .card-footer { opacity: .8; }
.product-card.dimmed:hover .product-card-img img { transform: none; }

/* Normalize footer row height so badge position is consistent */
.product-card .product-meta-row {
  min-height: 1.5rem; /* match typical text line height */
}

/* Truncate to 2 lines where supported */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Inline catalog drawer layout */
#category-layout {
  display: flex;
  gap: 0; /* remove implicit space between sidebar and grid */
  align-items: flex-start;
}
#categorySidebar {
  width: 200px;
  flex-shrink: 0;
  transition: width .3s ease, opacity .2s ease;
  opacity: 1;
  overflow: hidden;
  padding: 0;
  will-change: width;
}
#category-tree-inline { width: 500px; }
#productGridCol {
  flex: 1 1 auto;
  min-width: 0;
  transition: flex-basis .3s ease, max-width .3s ease;
}
.catalog-expanded #categorySidebar,
#categorySidebar { margin-right: 1.5rem; }
.catalog-collapsed #categorySidebar {
  width: 0 !important;
  margin-right: 0 !important;
  padding: 0 !important;
  opacity: 0 !important;
  pointer-events: none !important;
  border: 0 !important;
}

/* Mobile: stack, with collapsible height for the catalog */
@media (max-width: 991.98px) {
  #category-layout {
    flex-direction: column;
  }
  #categorySidebar {
    width: 100%;
    transition: height .3s ease, opacity .2s ease;
    margin-right: 0; /* no side margin when stacked */
    margin-bottom: 1.5rem; /* space below when expanded */
  }
  #category-tree-inline { width: 100%; }
  .catalog-collapsed #categorySidebar {
    /* Collapse from the bottom like desktop collapses from the right */
    height: 0;
    margin-bottom: 0;
    opacity: 0;
  }
}
